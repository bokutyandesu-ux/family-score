<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Family Coin</title>

<style>
body{
font-family:sans-serif;
margin:0;
background:linear-gradient(135deg,#eaf6ff,#ffffff);
text-align:center;
}

.container{
max-width:900px;
margin:auto;
padding:20px;
}

.card{
background:white;
padding:15px;
margin:10px 0;
border-radius:15px;
box-shadow:0 4px 12px rgba(0,0,0,0.08);
}

.rank1{border-left:6px solid gold;}
.rank2{border-left:6px solid silver;}
.rank3{border-left:6px solid #cd7f32;}

button{
background:#0077ff;
color:white;
border:none;
padding:8px 14px;
border-radius:8px;
margin:5px;
cursor:pointer;
}

input,select{
padding:8px;
border-radius:8px;
border:1px solid #ccc;
margin:5px;
width:90%;
}

.hidden{display:none;}

@media(min-width:700px){
.flex{
display:flex;
gap:20px;
}
.left,.right{
flex:1;
}
}
</style>
</head>

<body>
<div class="container">

<h1>ğŸ¦ Family Coin</h1>

<h3>å®¶æ—ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</h3>
<input type="password" id="familyPass">
<button onclick="enter()">å…¥ã‚‹</button>

<div id="main" class="hidden">

<div class="flex">

<div class="left">
<h2>ğŸ† ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h2>
<div id="ranking"></div>
</div>

<div class="right">

<h2>ğŸ’¸ é€é‡‘</h2>
<select id="fromUser"></select><br>
<select id="toUser"></select><br>
<input type="number" id="amount" placeholder="ãƒã‚¤ãƒ³ãƒˆ"><br>
<input type="text" id="reason" placeholder="ç†ç”±ï¼ˆå¿…é ˆï¼‰"><br>
<button onclick="transfer()">é€ã‚‹</button>

<hr>

<h3>ğŸ”‘ ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆå…„ï¼‰</h3>
<input type="password" id="adminPass">
<button onclick="adminLogin()">ãƒ­ã‚°ã‚¤ãƒ³</button>

<div id="adminPanel" class="hidden">
<h4>ãƒã‚¤ãƒ³ãƒˆç›´æ¥å¤‰æ›´</h4>
<select id="adminUser"></select><br>
<input type="number" id="adminAmount" placeholder="å¢—æ¸›ãƒã‚¤ãƒ³ãƒˆ"><br>
<input type="text" id="adminReason" placeholder="ç†ç”±ï¼ˆå¿…é ˆï¼‰"><br>
<button onclick="adminChange()">å¤‰æ›´</button>

<h4>ğŸ“œ å±¥æ­´ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰</h4>
<div id="history"></div>
</div>

</div>
</div>

</div>
</div>

<script>
const adminPassword="nandesitteru";

let users=[
{name:"å…„",score:0,password:"ani123"},
{name:"å¦¹1",score:0,password:"imo1"},
{name:"å¦¹2",score:0,password:"imo2"},
{name:"æ¯",score:0,password:"mama"},
{name:"çˆ¶",score:0,password:"papa"}
];

let currentUser=null;
let isAdmin=false;
let history=[];

function toggleLogin(){
document.getElementById("loginBox").classList.toggle("hidden");
renderLoginSelect();
}

function renderLoginSelect(){
let sel=document.getElementById("loginUser");
sel.innerHTML="";
users.forEach(u=>{
sel.innerHTML+=`<option>${u.name}</option>`;
});
}

function login(){
let name=document.getElementById("loginUser").value;
let pass=document.getElementById("loginPass").value;
let user=users.find(u=>u.name===name);

if(user.password===pass){
currentUser=name;
document.getElementById("loginStatus").innerHTML="ğŸ‘¤ "+name;
document.getElementById("loginBox").classList.add("hidden");
}else{
alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰é•ã„ã¾ã™");
}
render();
}

function logout(){
currentUser=null;
document.getElementById("loginStatus").innerHTML="æœªãƒ­ã‚°ã‚¤ãƒ³";
render();
}

function render(){
let sorted=[...users].sort((a,b)=>b.score-a.score);
let html="";
sorted.forEach((u,i)=>{
let rankClass="";
if(i==0)rankClass="rank1";
if(i==1)rankClass="rank2";
if(i==2)rankClass="rank3";
html+=`<div class="card ${rankClass}">${i+1}ä½<br><b>${u.name}</b><br>${u.score} pt</div>`;
});
document.getElementById("ranking").innerHTML=html;

let toSel=document.getElementById("toUser");
toSel.innerHTML="";
users.forEach(u=>{
if(u.name!==currentUser){
toSel.innerHTML+=`<option>${u.name}</option>`;
}
});

let adminSel=document.getElementById("adminUser");
adminSel.innerHTML="";
users.forEach(u=>{
adminSel.innerHTML+=`<option>${u.name}</option>`;
});

if(currentUser){
document.getElementById("transferBox").classList.remove("hidden");
document.getElementById("needLogin").classList.add("hidden");
}else{
document.getElementById("transferBox").classList.add("hidden");
document.getElementById("needLogin").classList.remove("hidden");
}

if(isAdmin){
renderHistory();
}
}

function transfer(){
if(!currentUser)return;

let to=document.getElementById("toUser").value;
let amount=parseInt(document.getElementById("amount").value);
let reason=document.getElementById("reason").value.trim();

if(!reason)return alert("ç†ç”±å¿…é ˆ");
if(amount<=0)return alert("æ­£ã—ã„é‡‘é¡");

let fromUser=users.find(u=>u.name===currentUser);
let toUser=users.find(u=>u.name===to);

if(fromUser.score<amount)return alert("æ®‹é«˜ä¸è¶³");

fromUser.score-=amount;
toUser.score+=amount;

history.unshift(`${new Date().toLocaleString()} | ${currentUser} â†’ ${to} | ${amount}pt | ${reason}`);

render();
}

function adminLogin(){
if(document.getElementById("adminPass").value===adminPassword){
isAdmin=true;
document.getElementById("adminPanel").classList.remove("hidden");
renderHistory();
}else{
alert("é•ã„ã¾ã™");
}
}

function adminChange(){
if(!isAdmin)return;

let name=document.getElementById("adminUser").value;
let amount=parseInt(document.getElementById("adminAmount").value);
let reason=document.getElementById("adminReason").value.trim();
if(!reason)return alert("ç†ç”±å¿…é ˆ");

let user=users.find(u=>u.name===name);
user.score+=amount;

history.unshift(`${new Date().toLocaleString()} | ç®¡ç†è€…å¤‰æ›´ | ${name} | ${amount}pt | ${reason}`);

render();
}

function renderHistory(){
let html="";
if(history.length===0){
html="å±¥æ­´ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“";
}else{
history.forEach(h=>{
html+=h+"<br>";
});
}
document.getElementById("history").innerHTML=html;
}

render();
</script>

</body>
</html>

